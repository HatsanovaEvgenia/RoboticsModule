# Кинематический анализ. Прямая задача кинематики. Параметры Денавита-Хартенберга. Расчет углов Эйлера.

## Кинематический анализ.

Целью кинематического анализа является определение положения, скорости и ускорения произвольной точки звена исполнительного механизма (чаще всего схвата) в различных системах координат.

При решении прямой задачи о положении схвата манипулятора обычно используют метод преобразования координат. Методов преобразования координат несколько, но для манипуляторов обычно используется метод Денавита и Хартенберга.

Для описания геометрии робота-манипулятора используют так называемую **кинематическую схему** (кинематическую цепь), которая представляет собой графическое изображение последовательности звеньев манипулятора, соединенных между собой сочленениями.

Различают два базовых (элементарных) типа сочленений с одной степенью свободы: **вращательный** и **поступательный**. При наличии первого из них относительное расположение смежных звеньев определяется угловой переменной, при наличии второго — линейным смещением. В обоих случаях эти переменные называются обобщенными координатами и обозначаются $q_i$.

Кинематический анализ робота-манипулятора предполагает решение двух основополагающих задач: прямой и обратной задач кинематики<sup>[2]</sup>.

## Прямая задача кинематики.

**Прямая задача кинематики** отвечает на вопрос: где будет находится и как будет ориентирован схват или рабочий орган манипулятора, при заданных значениях обобщенных координат. Решение ПЗК (Прямой задачи кинематики) используется при моделировании движения манипулятора, управлении роботами, расчёте траекторий и симуляции в CAD/CAM.

Если рассматривать схват манипулятора как твердое тело, без привязки к самому манипулятору, то его положение в трехмерном пространстве задается шестью значениями: три для координат и три для углов.

Использование метода, предложенного в 1955 г. учеными Жаком Денавитом и Ричардом Хартенбергом, позволяет сократить это число до четырех параметров, называемыми параметрами Денавита-Хартенберга. Такое упрощение достигается с помощью стандартизированного алгоритма привязки систем координат к звеньям манипулятора<sup>[2]</sup>.

Согласно методу Денавита-Хартенберга решение состоит из следующих шагов:

- Шаг 1. Привязка систем координат к звеньям.
- Шаг 2. Определение параметров Денавита-Хартенберга.
- Шаг 3. Построение матриц однородного преобразования.
- Шаг 4. Расчет углов Эйлера по итоговой матрице вращения.

Расставляем системы координат. Это не такая тривиальная задача, как может показаться на первый взгляд. К тому же метод Денавита-Хартенберга не подразумевает единственно-верного способа расстановки систем координат, но итоговый результат должен быть одинаковым.

Введем определения:
**Кинематическая пара** – подвижное соединение двух кинематических
звеньев, допускающее их вполне определенное движение относительно друг
друга.
**Кинематическое звено** – совокупность жестко соединенных друг с другом тел, входящих в состав механизма, в данном случае в состав манипулятора.

## Параметры Денавита-Хартенберга.

Разберем метод Денавита-Хартенберга на примере этой кинематической схемы:

![alt text](/Lessons/img/lecture_2/1.jpg)

Определим звенья у манипулятора. Пронумеруем кинематические звенья от неподвижного звена до наиболее удаленного, на котором закреплен схват, присвоив им соответственно номера от 0 до n, где n – число подвижных звеньев манипулятора.

![alt text](/Lessons/img/lecture_2/2.jpg)

Обозначим кинематические пары символом $A_i$, нижний индекс которого равен меньшему из номеров звеньев, образующих кинематическую пару.

![alt text](/Lessons/img/lecture_2/3.jpg)

**Введем понятие оси $z_i$ i-й кинематической пары.**

Осью $z_i$ i-й вращательной кинематической пары ($A_i$), соединяющей i-ое звено с (i+1)-м является ось шарнира кинематической пары. Эту ось будем считать принадлежащей i-му звену и жестко с ним соединенной. Именно вокруг этой оси вращается (i+1)-е звено относительно i-го.

Осью $z_i$ _поступательной пары_ является какая-либо из прямых, параллельная направляющей данной поступательной пары.

Если ось $z_i$ не параллельна оси $z_{i-1}$, то ее рекомендуется направлять так, чтобы она пересекалась с этой осью. За положительное направление оси $z_i$ можно взять любое, в частности, направления снизу вверх, слева направо, к наблюдателю от наблюдателя или близкие к ним направления.

![alt text](/Lessons/img/lecture_2/4.jpg)

Теперь нужно расставить начала систем координат и оставшиеся оси. На самом деле по правилам мы расставляем только ось x, а ось y встает так, чтобы образовалась правая тройка векторов. Напомним, что правая тройка векторов выглядит так:
![alt text](/Lessons/img/lecture_2/5.jpg)

Есть общее правило расстановки: начало координат располагается в точке пересечения линии кратчайшего расстояния между осями $z_i$ и $z_{i-1}$ с осью $z_i$. В этом случае ось $х_i$ направляется по линии кратчайшего расстояния в сторону от оси $z_{i-1}$ к оси $z_i$. Это наиболее общий случай. Другие варианты взаиморасположения осей $z_{i-1}$ и $z_i$ следует рассматривать как частные рассмотренного.
![alt text](/Lessons/img/lecture_2/6.jpg)

Вот частные случаи расположений осей:

![alt text](/Lessons/img/lecture_2/7.jpg)
![alt text](/Lessons/img/lecture_2/8.jpg)
![alt text](/Lessons/img/lecture_2/9.jpg)

А вот так расположились оси на кинематической схеме:

![](/Lessons/img/lecture_2/10.jpg)

Эти правила не действуют в полной мере при выборе системы координат, связанной со стойкой (звено 0), так как отсутствует (i-1)–я кинематическая пара, и системы координат, связанной с последним звеном, на котором закрепляется схват, так как это последнее звено не содержит кинематической пары для соединения со следующим звеном.
Начало системы координат, связанной со стойкой, может быть расположено в любой точке оси $z_0$, а направление оси $x_0$ принимается произвольно по дополнительным условиям<sup>[3]</sup>, если это не указано отдельно в документации робота.

Начало $А_n$ системы координат, связанной с последним n-м звеном манипулятора, на котором закреплен схват, располагается в точке, принимаемой за центр схвата (за характерную точку схвата), а ось $х_n$ направляется перпендикулярно оси $z_{n-1}$. Оси $z_n$ может быть назначено произвольное направление, например, по оси захватываемой детали или технологического инструмента или перпендикулярно ей.

![](/Lessons/img/lecture_2/11.jpg)

**Параметры звеньев по соглашению D–H <sup>[4]</sup>**

**1.** $a_i$ — расстояние вдоль $x_i$ от точки $A_i$ до пересечения осей $x_i$ и $z_{i-1}$;

**2.** $d_i$ — расстояние вдоль $z_{i-1}$ от точки $A_{i-1}$ до пересечения осей $x_i$ и $z_{i-1}$. Параметр $d_i$ переменный, если сочленение $i$ поступательное;

**3.** $\alpha_i$ — угол между $z_{i-1}$ и $z_i$, измеренный вокруг оси $x_i$;

**4.** $\theta_i$ — угол между $x_{i-1}$ и $x_i$, измеренный вокруг оси $z_{i-1}$.Параметр $\theta_i$ переменный, если сочленение $i$ вращательное.

**Для первого звена (i=1):**

![](/Lessons/img/lecture_2/12.jpg)

**1.** $a_1$ — расстояние вдоль $x_1$ от точки $A_1$ до пересечения осей $x_1$ и $z_{0}$; $$a_1 = 0$$

**2.** $d_1$ — расстояние вдоль $z_{0}$ от точки $A_{0}$ до пересечения осей $x_1$ и $z_{0}$. Параметр $d_1$ переменный, если сочленение $1$ поступательное; $$d_1 = l_1$$

**3.** $\alpha_1$ — угол между $z_{0}$ и $z_1$, измеренный вокруг оси $x_1$;
$$\alpha_1 = \frac{\pi}{2}$$

**4.** $\theta_1$ — угол между $x_{0}$ и $x_1$, измеренный вокруг оси $z_{0}$.Параметр $\theta_1$ переменный, если сочленение $1$ вращательное.  
$$\theta_1 = q1$$

**Для второго звена (i=2):**

Покажем, как именно отмеряем угол $q_2$, чтоб корректно рассчитать параметры.

![](/Lessons/img/lecture_2/13.jpg)

**1.** $a_2$ — расстояние вдоль $x_2$ от точки $A_2$ до пересечения осей $x_2$ и $z_{1}$; $$a_2 = l_2$$

**2.** $d_2$ — расстояние вдоль $z_{1}$ от точки $A_{1}$ до пересечения осей $x_2$ и $z_{1}$. Параметр $d_2$ переменный, если сочленение $2$ поступательное; $$d_2 = 0$$

**3.** $\alpha_2$ — угол между $z_{1}$ и $z_2$, измеренный вокруг оси $x_2$;
$$\alpha_2 = 0$$

**4.** $\theta_2$ — угол между $x_{1}$ и $x_2$, измеренный вокруг оси $z_{1}$.Параметр $\theta_2$ переменный, если сочленение $2$ вращательное.  
$$\theta_2 = q_2$$

**Для третьего звена (i=3):**

Покажем, как именно отмеряем угол $q_3$, чтоб корректно рассчитать параметры.

![](/Lessons/img/lecture_2/14.jpg)

**1.** $a_3$ — расстояние вдоль $x_3$ от точки $A_3$ до пересечения осей $x_3$ и $z_{2}$; $$a_3 = l_3$$

**2.** $d_3$ — расстояние вдоль $z_{2}$ от точки $A_{2}$ до пересечения осей $x_3$ и $z_{2}$. Параметр $d_3$ переменный, если сочленение $3$ поступательное; $$d_3 = 0$$

**3.** $\alpha_3$ — угол между $z_{2}$ и $z_3$, измеренный вокруг оси $x_3$;
$$\alpha_3 = 0$$

**4.** $\theta_3$ — угол между $x_{2}$ и $x_3$, измеренный вокруг оси $z_{2}$.Параметр $\theta_3$ переменный, если сочленение $3$ вращательное.  
$$\theta_3 = q_3$$

**Таблица параметров Денавита-Хартенберга**

| Параметр | $a_i$   | $d_i$   | $\alpha_i$       | $\theta_i $ |
| -------- | ------- | ------- | ---------------- | ----------- |
| Звено 1  | 0       | $$l_1$$ | $$\frac{pi}{2}$$ | $$q_1$$     |
| Звено 2  | $$l_2$$ | 0       | 0                | $$q_2$$     |
| Звено 3  | $$l_3$$ | 0       | 0                | $$q_3$$     |

Каждое из упомянутых элементарных движений описывается соответствующей частной матрицей перехода:

1. Поворот вокруг оси $z_{i-1}$ на угол $\Theta_i$:

$$
R^{z_{i-1}}_{\Theta_i} =
\begin{bmatrix}
cos \theta_i & -sin\theta_i & 0 & 0 \\
sin\theta_i &  cos\theta_i & 0 & 0 \\
0         &  0         & 1 & 0 \\
0         &  0         & 0 & 1
\end{bmatrix}
$$

2. Сдвиг по оси $z_{i-1}$ на величину $d_i$:

$$
T^{z_{i-1}}_{d_i} =
\begin{bmatrix}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & 1 & d_i \\
0 & 0 & 0 & 1
\end{bmatrix}
$$

3. Сдвиг по оси $x_i$ на величину $a_i$:

$$
T^{x_{i}}_{a_i} =
\begin{bmatrix}
1 & 0 & 0 & a_i \\
0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1
\end{bmatrix}
$$

4. Поворот вокруг оси $x_i$ на угол $\alpha_i$:

$$
R^{x_{i}}_{\alpha_i} =
\begin{bmatrix}
1 & 0 & 0 & 0 \\
0 & cos \alpha_i & -sin \alpha_i & 0 \\
0 & sin \alpha_i & cos \alpha_i & 0 \\
0 & 0 & 0 & 1
\end{bmatrix}
$$

На предыдущем шаге были получены четыре параметры для каждого звена манипулятора. Теперь из них необходимо построить соответствующие матрицы однородного преобразования следующим образом:

$A_i = R_{\theta_i} * T_{d_i} * T_{a_i} * R_{\alpha_i}$

$$
A_i =
\begin{bmatrix}
cos \theta_i & -sin \theta_i cos \alpha_i & sin \theta_i sin \alpha_i & a_i cos\theta_i \\
sin\theta_i & cos\theta_i cos\alpha_i  & -cos\theta_i sin\alpha_i & a_i\sin\theta_i \\
0            & sin\alpha_i              & cos\alpha_i              & d_i \\
0            & 0                         & 0                         & 1
\end{bmatrix}
$$

Подставив все параметры Денавита-Хартенберга, получим 𝑛 матриц однородного преобразования:

$$
A_1 =
\begin{bmatrix}
cos q_1 & -sin q_1 * cos\frac{pi}{2} & sin q_1 * sin\frac{pi}{2} & 0 * cos q_1 \\
sin q_1 & cos q_1 * cos\frac{pi}{2}  & -cos q_1 * sin\frac{pi}{2} & 0 * sin q_1 \\
0            & sin\frac{pi}{2}              & cos\frac{pi}{2}              & l_1 \\
0            & 0                         & 0                         & 1
\end{bmatrix}
$$

$$ = $$

$$
\begin{bmatrix}
cos q_1  & -sin q_1 * 0   & sin q_1 * 1    & 0 * cos q_1 \\
sin q_1  & cos q_1 * 0    & -cos q_1 * 1    & 0 * sin q_1 \\
0         & 1               & 0              & l_1 \\
0         & 0               & 0              & 1
\end{bmatrix}
$$

$$ = $$

$$
\begin{bmatrix}
cos q_1  & 0               & sin q_1       & 0 \\
sin q_1  & 0               & -cos q_1      & 0 \\
0         & 1               & 0              & l_1 \\
0         & 0               & 0              & 1
\end{bmatrix}
$$

$$
A_2 =
\begin{bmatrix}
cos q_2 & -sin q_2 & 0 & l_2 * cos q_2 \\
sin q_2 &  cos q_2 & 0 & l_2 * sin q_2 \\
0        & 0         & 1 & 0 \\
0        & 0         & 0 & 1
\end{bmatrix}
$$

$$
A_3 =
\begin{bmatrix}
cos q_3 & -sin q_3 & 0 & l_3 * cos q_3 \\
sin q_3 &  cos q_3 & 0 & l_3 * sin q_3 \\
0        & 0         & 1 & 0 \\
0        & 0         & 0 & 1
\end{bmatrix}
$$

Итоговую матрицу, связывающую все системы координат, как и в
случае с матрицами вращения, можно получить последовательным перемножением:

$$
T =
\begin{bmatrix}
cos q_1 * cos(q_2 + q_3) & -cos q_1 * sin(q_2 + q_3) & sin q_1   & ( l_2 * cos q_2 + l_3 * cos(q_2 + q_3)) * cos q_1 \\
sin q_1 * cos(q_2 + q_3) & -sin q_1 * sin(q_2 + q_3) & -cos q_1  & ( l_2 * cos q_2 + l_3 * cos(q_2 + q_3)) * sin q_1 \\
sin(q_2 + q_3)           &  cos(q_2 + q_3)           & 0         & l_1 + l_2 * sin q_2 + l_3 * sin(q_2 + q_3) \\
0                        &  0                        & 0         & 1
\end{bmatrix}
$$

$$
T^0_n(q) =
\begin{bmatrix}
R^0_n(q) &  p^0_n(q)\\
0 & 1
\end{bmatrix}
$$

Здесь матрица вращения $R^0_n(q)$ и вектор $p^0_n(q)$ задают, соответственно, ориентацию и положение системы координат, связанной со схватом или рабочим органом, относительно базовой системы в зависимости от конфигурации манипулятора, заданной вектором обобщенных координат
𝑞.

Нами на предыдущем шаге была получена матрица однородного преобразования $T$, которая и содержит искомую информацию, представленную в виде матрицы вращения $R^0_3(q)$ и вектора $p^0_3(q)$.

Касательно линейных (декартовых) координат, вектор $p^0_3(q)$ имеет следующие компоненты:

$$
p^0_3(q) =
\begin{bmatrix}
x^0_3(q) \\
y^0_3(q) \\
z^0_3(q)
\end{bmatrix}
$$

$$ = $$

$$
\begin{bmatrix}
( l_2 * cos q_2 + l_3 * cos(q_2 + q_3)) * cos q_1 \\
( l_2 * cos q_2 + l_3 * cos(q_2 + q_3)) * sin q_1 \\
l_1 + l_2 * sin q_2 + l_3 * sin(q_2 + q_3)
\end{bmatrix}
$$

которые и являются решением ПЗК по положению в явном виде.

## Заключение

Прямая задача кинематики позволяет определить положение и ориентацию рабочего органа манипулятора при заданных обобщённых координатах. Для её решения используется метод преобразований координат, наиболее удобной и распространённой формой которого является метод Денавита–Хартенберга.

Метод DH позволяет описать всю кинематическую цепь через четыре параметра для каждого звена, что упрощает математический аппарат и делает задачу универсальной для любых роботов-манипуляторов. Последовательное перемножение матриц однородных преобразований даёт итоговую матрицу, содержащую как матрицу вращения $R^0_n(q)$, так и вектор положения $p^0_n(q)$.

Таким образом, мы получили явное решение прямой задачи кинематики, это решение является фундаментом для дальнейшего изучения обратной задачи кинематики, анализа движения, расчёта траекторий и управления роботами.

## Библиографический список.

[1]: https://mnk.mpei.ru/PDF/NAUKA/Kin2000.pdf

<sup>[1]</sup> Корецкий А.В., Осадченко Н.В.
Компьютерное моделирование кинематики манипуляционных
роботов. – М.: Издательство МЭИ, 2000. – 48 с.

[2]: https://books.ifmo.ru/file/pdf/2094.pdf

<sup>[2]</sup> Борисов О.И., Громов В.С., Пыркин А.А., Методы управления робототехническими приложениями. Учебное пособие. — СПб.: Университет
ИТМО, 2016. — 108 с.

[3]: https://synergy-network.ru/wp-content/uploads/2018/01/rtsomsk.pdf?ysclid=megz6kwd1s987581052

<sup>[3]</sup> В. Г. Хомченко, Робототехнические системы: Учебное пособие, Омск 2016 г. – 195 стр.

[4]: https://users.cs.duke.edu/~brd/Teaching/Bio/asmb/current/Papers/chap3-forward-kinematics.pdf

<sup>[4]</sup> FORWARD KINEMATICS: THE DENAVIT-HARTENBERG CONVENTION
